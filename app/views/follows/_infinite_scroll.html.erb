<% if followers.total_pages > 1 %>
  <script>
    $('#top_contents').infiniteScroll({
      path: '.navigation a[rel=next]',
      append: '<%= read_class %>',
      history: 'replace',
      // checkLastPage: true,
      responseType: 'document'
    });

    <%# kaminari と infinite scroll の組み合わせだとcheckLastPageが正常に機能せず、最後のページになっても次のページのリクエストを飛ばし続けるので、力業で終了させる %>
    $('#top_contents').on( 'load.infiniteScroll', function(event, response, path) {
      page = path.replace(/.*page=/, "")
      if(Number(page) > <%= followers.total_pages %>) {
        $('#top_contents').infiniteScroll('destroy');
        return;
      }
    });
  </script>
<% end -%>